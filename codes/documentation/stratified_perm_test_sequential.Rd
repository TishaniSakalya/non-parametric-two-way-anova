% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stratified_perm_test_sequential.R
\name{stratified_perm_test_sequential}
\alias{stratified_perm_test_sequential}
\title{Stratified Permutation Test with Sequential Permutations}
\usage{
stratified_perm_test_sequential(data, B = 1000)
}
\arguments{
\item{data}{A data.table containing the columns `A`, `B`, and `Y`.}

\item{B}{An integer specifying the number of permutations to perform. Default is 1000.}
}
\value{
A list containing:
  \itemize{
    \item `eta_A`: The observed eta-squared value for the main effect `A`.
    \item `eta_B`: The observed eta-squared value for the main effect `B`.
    \item `eta_interaction`: The observed eta-squared value for the interaction effect (`A * B`).
    \item `p_eta_A`: The p-value for the main effect `A`.
    \item `p_eta_B`: The p-value for the main effect `B`.
    \item `p_eta_interaction`: The p-value for the interaction effect (`A * B`).
  }
}
\description{
This function performs a stratified permutation test with sequential permutations,
where data for the main effects (`A` and `B`) and interaction (`A * B`) are permuted separately.
It calculates eta-squared values for each effect, computes p-values by comparing
permuted values with the observed eta-squared values, and generates density plots for visualization.
}
\details{
The function runs `B` permutations, where data for `A`, `B`, and their interaction
  are permuted separately. For each permutation, eta-squared values are calculated and
  compared with the observed values. P-values are computed as the proportion of
  permuted values greater than or equal to the observed values.

  The function also generates density plots for the eta-squared values of `A`, `B`,
  and their interaction, with the observed values shown as dashed lines.
}
\examples{
# Example data.table
data <- data.table(A = factor(c('low', 'medium', 'high', 'low', 'high')),
                   B = factor(c('red', 'blue', 'red', 'blue', 'red')),
                   Y = c(10, 20, 30, 40, 50))

# Perform stratified permutation test with 1000 permutations
results <- stratified_perm_test_sequential(data, B = 1000)
print(results)

# Create a data frame to mimic an ANOVA table
anova_table <- data.frame(
  Term = c("A", "B", "A:B (Interaction)"),
  Eta_Squared = c(results$eta_A, results$eta_B, results$eta_interaction),
  P_Value = c(results$p_eta_A, results$p_eta_B, results$p_eta_interaction),
  Significance = c(
    ifelse(results$p_eta_A < 0.05, "***", ""),
    ifelse(results$p_eta_B < 0.05, "***", ""),
    ifelse(results$p_eta_interaction < 0.05, "**", "")
  )
)

# Print the table in a clear format
print(anova_table)

}
